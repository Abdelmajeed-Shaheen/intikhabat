{% extends 'candidate_base.html' %}


{% block extra_content %}
  <header id="header">
    <div class="container-ar d-flex align-items-center" >
      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li><a href="{% url 'logout' %}">تسحيل خروج</a></li>
          {% if request.user.userprofile.candidate or request.user.userprofile.campaignadminstrator %}
          <li><a href="{% url 'main' %}">عودة</a></li>
          {% else %}
    <li><a href="{% url 'comittee-member' %}">عودة</a></li>
          {% endif %}
        </ul>
      </nav>
      <!-- .nav-menu -->

    </div>
  </header>
{% endblock %}
{% block main %}

<div class="container mt-3 text-aligner">
<div class="row">
    <h1 class="about-title text-aligner">{{task.title}}</h1>
</div>
<div class="row">
        <div class="col-lg-6">
          <label >وصف المهمة</label>
          <p>{{task.description}}</p>
        </div>
        <div class="col-lg-6">
          <label >  اضافة ملاحظات  </label>
          {{form.notes}}
        </div>
</div>

<div class="row">
  <div class="col-lg-3">
    <label >اللجنة</label>
    <h4>{{task.comittee}}</h4>
    
  </div>

  <div class="col-lg-3">
    <label >انشئ بواسطة</label>
    <h4> {{task.created_by.user.first_name}} {{task.created_by.user.last_name}} </h4>

  </div>
  <div class="col-lg-3">
    <label >تم انجازها ؟</label>
    <h4> {{form.is_complete}} </h4>

  </div>
  <div class="col-lg-3 mt-2 text-left">
    <button class="btn  btn-info" id ="updateTask">حفظ</button>
  </div>
</div>
</div>

{% endblock %}

{% block js %}
<script>
  $("#updateTask").on("click",function(){
    notes=$("#id_notes").val()
    if ($("#id_is_complete").is(":checked")){
      is_complete=true
    }
    else{
      is_complete=false
    }
    data=new Object()
    data.is_complete=is_complete
    data.notes=notes
    data.task_id='{{task.id}}'
    datajson=JSON.stringify(data)
    $.ajax({
      url:"{% url 'update-task' task.id %}",
      type:'POST',
      data:{
        data:datajson,
        csrfmiddlewaretoken:'{{ csrf_token }}'
      },

      success:function(result){
        console.log(result)
      }

    })
  })
</script>
{% endblock js %}